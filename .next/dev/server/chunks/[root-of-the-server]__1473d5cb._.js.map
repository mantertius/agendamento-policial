{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/manoe/OneDrive/Desktop/Programming/agendamento-policial/app/api/send-email/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\r\nimport nodemailer from 'nodemailer';\r\n\r\n// Configuração do transporter do Gmail\r\n// Para usar, você precisa:\r\n// 1. Habilitar \"Acesso a apps menos seguros\" OU\r\n// 2. Criar uma \"Senha de App\" em https://myaccount.google.com/apppasswords\r\nconst transporter = nodemailer.createTransport({\r\n  service: 'gmail',\r\n  auth: {\r\n    user: process.env.GMAIL_USER, // seu-email@gmail.com\r\n    pass: process.env.GMAIL_APP_PASSWORD, // senha de app gerada no Google\r\n  },\r\n});\r\n\r\nexport async function sendEmail({\r\n  to,\r\n  subject,\r\n  html,\r\n}: {\r\n  to: string;\r\n  subject: string;\r\n  html: string;\r\n}) {\r\n  const mailOptions = {\r\n    from: process.env.GMAIL_USER,\r\n    to,\r\n    subject,\r\n    html,\r\n  };\r\n\r\n  return transporter.sendMail(mailOptions);\r\n}\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { to, subject, html } = await request.json();\r\n\r\n    if (!to || !subject || !html) {\r\n      return NextResponse.json(\r\n        { error: 'Campos obrigatórios: to, subject, html' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Verificar se as credenciais estão configuradas\r\n    if (!process.env.GMAIL_USER || !process.env.GMAIL_APP_PASSWORD) {\r\n      console.warn('Credenciais do Gmail não configuradas. Email não enviado.');\r\n      return NextResponse.json({\r\n        success: true,\r\n        message: 'Email não enviado (credenciais não configuradas)',\r\n        emailSent: false,\r\n      });\r\n    }\r\n\r\n    await transporter.sendMail({\r\n      from: `\"Agendamento Policial\" <${process.env.GMAIL_USER}>`,\r\n      to,\r\n      subject,\r\n      html,\r\n    });\r\n\r\n    return NextResponse.json({ success: true, emailSent: true });\r\n  } catch (error) {\r\n    console.error('Erro ao enviar email:', error);\r\n    return NextResponse.json(\r\n      { error: 'Erro ao enviar email', details: String(error) },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,uCAAuC;AACvC,2BAA2B;AAC3B,gDAAgD;AAChD,2EAA2E;AAC3E,MAAM,cAAc,6NAAU,CAAC,eAAe,CAAC;IAC7C,SAAS;IACT,MAAM;QACJ,MAAM,QAAQ,GAAG,CAAC,UAAU;QAC5B,MAAM,QAAQ,GAAG,CAAC,kBAAkB;IACtC;AACF;AAEO,eAAe,UAAU,EAC9B,EAAE,EACF,OAAO,EACP,IAAI,EAKL;IACC,MAAM,cAAc;QAClB,MAAM,QAAQ,GAAG,CAAC,UAAU;QAC5B;QACA;QACA;IACF;IAEA,OAAO,YAAY,QAAQ,CAAC;AAC9B;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEhD,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,MAAM;YAC5B,OAAO,iNAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAyC,GAClD;gBAAE,QAAQ;YAAI;QAElB;QAEA,iDAAiD;QACjD,IAAI,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI,CAAC,QAAQ,GAAG,CAAC,kBAAkB,EAAE;YAC9D,QAAQ,IAAI,CAAC;YACb,OAAO,iNAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,SAAS;gBACT,WAAW;YACb;QACF;QAEA,MAAM,YAAY,QAAQ,CAAC;YACzB,MAAM,CAAC,wBAAwB,EAAE,QAAQ,GAAG,CAAC,UAAU,CAAC,CAAC,CAAC;YAC1D;YACA;YACA;QACF;QAEA,OAAO,iNAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,WAAW;QAAK;IAC5D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,iNAAY,CAAC,IAAI,CACtB;YAAE,OAAO;YAAwB,SAAS,OAAO;QAAO,GACxD;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}